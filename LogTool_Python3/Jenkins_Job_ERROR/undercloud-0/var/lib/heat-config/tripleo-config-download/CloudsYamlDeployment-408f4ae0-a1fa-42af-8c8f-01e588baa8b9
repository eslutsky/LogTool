[{"config": "#!/usr/libexec/platform-python\n# Copyright 2018, 2019 Red Hat, Inc.\n# All Rights Reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\"); you may\n# not use this file except in compliance with the License. You may obtain\n# a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n# License for the specific language governing permissions and limitations\n# under the License.\n\nimport os\n\nfrom tripleo_common.utils import clouds_yaml\nfrom tripleoclient import constants\n\n\ndef _get_cloud_config():\n    cloud_config = {\n        os.environ[\"cloud_name\"]: {\n            \"auth\": {\n                \"auth_url\": os.environ[\"auth_url\"],\n                \"project_name\": os.environ[\"project_name\"],\n                \"project_domain_name\": os.environ[\"project_domain_name\"],\n                \"username\": os.environ[\"user_name\"],\n                \"user_domain_name\": os.environ[\"user_domain_name\"],\n                \"password\": os.environ[\"admin_password\"],\n            },\n            \"region_name\": os.environ[\"region_name\"],\n            \"identity_api_version\": os.environ[\"identity_api_version\"],\n        }\n    }\n    return cloud_config\n\n\nif __name__ == \"__main__\":\n    cloud = _get_cloud_config()\n    home_dir = os.path.join(os.environ[\"home_dir\"])\n    user_id = os.stat(home_dir).st_uid\n    group_id = os.stat(home_dir).st_gid\n    clouds_yaml.create_clouds_yaml(\n        cloud=cloud,\n        cloud_yaml_dir=os.path.join(home_dir, constants.CLOUDS_YAML_DIR),\n        user_id=user_id,\n        group_id=group_id,\n    )\n\n    # Generate clouds.yaml globally\n    clouds_yaml.create_clouds_yaml(cloud=cloud)\n", "creation_time": "2020-03-04T03:03:06Z", "deployment_name": "CloudsYamlDeployment", "group": "script", "id": "408f4ae0-a1fa-42af-8c8f-01e588baa8b9", "inputs": [{"name": "admin_password", "description": null, "type": "String", "value": "Yq7PMRlKwa8QQ6XUT1kAJEUZz"}, {"name": "auth_url", "description": null, "type": "String", "value": "https://192.168.24.2:13000"}, {"name": "cloud_name", "description": null, "type": "String", "value": "undercloud"}, {"name": "home_dir", "description": null, "type": "String", "value": "/home/stack"}, {"name": "identity_api_version", "description": null, "type": "String", "value": "3"}, {"name": "project_name", "description": null, "type": "String", "value": "admin"}, {"name": "project_domain_name", "description": null, "type": "String", "value": "Default"}, {"name": "region_name", "description": null, "type": "String", "value": "regionOne"}, {"name": "user_name", "description": null, "type": "String", "value": "admin"}, {"name": "user_domain_name", "description": null, "type": "String", "value": "Default"}, {"name": "deploy_server_id", "description": "ID of the server being deployed to", "type": "String", "value": "1e6ea2e1-c44d-4e40-b09e-10d94ca508c0"}, {"name": "deploy_action", "description": "Name of the current action being deployed", "type": "String", "value": "CREATE"}, {"name": "deploy_stack_id", "description": "ID of the stack this deployment belongs to", "type": "String", "value": "undercloud-AllNodesDeploySteps-zuuy36jjpozg-UndercloudExtraConfigPost-chemsis6sbys-CloudsYamlDeployment-65kvyqo5b6v4-0-2ucjfgn5jr4g/55fc471b-1649-4a66-92ab-eb8edd5c8358"}, {"name": "deploy_resource_name", "description": "Name of this deployment resource in the stack", "type": "String", "value": "TripleOSoftwareDeployment"}, {"name": "deploy_signal_transport", "description": "How the server should signal to heat with the deployment output values.", "type": "String", "value": "NO_SIGNAL"}], "name": "deployment_resource", "options": {}, "outputs": null}]